<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <title>أسعار الليرة السورية لحظة بلحظة</title>
  <meta http-equiv="refresh" content="600" />
  <style>
    body {
      font-family: Arial;
      background: #111;
      color: #0f0;
      text-align: center;
      padding: 20px;
    }
  </style>
</head>
<body>
  <h1>🟢 أسعار الليرة السورية لحظة بلحظة</h1>
  <p id="board">Loading...</p>
  <p>تحديث تلقائي كل 10 دقائق</p>
  <p style="color: yellow">
    افتح أدوات المطور (F12)، ثم علامة التبويب Console لنسخ رمز FCM الخاص بك.
  </p>

  <!-- Firebase scripts -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-messaging-compat.js"></script>

  <script>
    // Your Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyANmR1UrR8aMUag3gNHrFFNmiXMQzekeXg",
      authDomain: "syrian-currency.firebaseapp.com",
      projectId: "syrian-currency",
      storageBucket: "syrian-currency.firebasestorage.app",
      messagingSenderId: "58493358809",
      appId: "1:58493358809:web:cfb1c9d70ef3f30e0424c8",
      measurementId: "G-8G3F9CJT38",
    };

    firebase.initializeApp(firebaseConfig);

    if ("serviceWorker" in navigator) {
      navigator.serviceWorker
        .register("/live-syrian-rates/firebase-messaging-sw.js")
        .then(function (registration) {
          const messaging = firebase.messaging();
          messaging
            .getToken({
              vapidKey:
                "BCE0fhf0V_z4H8-RXP0rF0DDmnAuIkj3wU8u4NHGx2Jw6DZNxnCwt19YiQ5XSQga71jUUD-G8pllS2ODcSKGJXU",
              serviceWorkerRegistration: registration,
            })
            .then(function (token) {
              if (token) {
                console.log("FCM Token:", token);
              } else {
                console.warn(
                  "No registration token available. Request permission."
                );
              }
            })
            .catch(function (err) {
              console.error("Error retrieving FCM token", err);
            });
        })
        .catch(function (err) {
          console.error("Service worker registration failed", err);
        });
    }
  </script>

  <script>
    // Your original board update code
    fetch(
      "https://raw.githubusercontent.com/live-syrian-rates/live-syrian-rates/main/live_board.json"
    )
      .then((r) => r.json())
      .then((d) => {
        document.getElementById("board").innerText =
          `دمشق  ${d.dam_buy} / ${d.dam_sell}  (فارق ${d.spread_dam})\n` +
          `حلب   ${d.ale_buy} / ${d.ale_sell}  (فارق ${d.spread_ale})\n` +
          `أونصة الذهب  ${d.gold} $`;
      })
      .catch(() => (document.getElementById("board").innerText = "جار التحميل..."));
  </script>
</body>
</html>
